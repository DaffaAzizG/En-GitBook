<script>
function activateSidebarToggle() {
    var chapters = document.querySelectorAll(".chapter.has-children > .chapter-title");

    chapters.forEach(function (el) {
        el.onclick = function (e) {
            // Jangan toggle kalau klik link
            if (e.target.tagName.toLowerCase() === "a") return;

            var parent = el.parentNode;
            parent.classList.toggle("open");
        };
    });

    // Buka otomatis jika halaman aktif
    var active = document.querySelector(".chapter.active");
    if (active) {
        var parent = active.parentElement;
        while (parent && parent.classList.contains("chapter")) {
            parent.classList.add("open");
            parent = parent.parentElement.closest(".chapter");
        }
    }
}

// Panggil saat DOM pertama kali dimuat
if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", activateSidebarToggle);
} else {
    activateSidebarToggle();
}

// Panggil setiap kali halaman GitBook berubah (SPA style)
if (typeof gitbook !== "undefined") {
    gitbook.events.on("page.change", function () {
        activateSidebarToggle();
    });
}
</script>
